<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
	</head>
	<body>
		<div id="wrap">
			<div id="header">
				<div id="headerTop">
					<h1 id="logo">
						<a href="#"><img src="img/logo.png" alt="logo" /></a>
					</h1>
					<a href="#" id="menuBtn" class="menuBtnClos"></a>
					<div id="navs">
						<a href="#">搜索</a>
						<a href="#">登录</a>
						<a href="#">注册</a>
					</div>
				</div>
				<form id="search">
					<input type="text" placeholder="请输入搜索内容"/> 
					<input type="submit" value="搜索"/>
				</form>
				<!--定位层-->
				<ul id="list">
					<li>
						<a href="javascript:;">首页</a>
					</li>
					<li>
						<a href="javascript:;">MV</a>
					</li>
					<li>
						<a href="javascript:;">悦单</a>
					</li>
					<li>
						<a href="javascript:;">V榜</a>
					</li>
					<li>
						<a href="javascript:;">音悦</a>
					</li>
					<li>
						<a href="javascript:;">商城</a>
					</li>
					<li>
						<a href="javascript:;">节目</a>
					</li>
					<li>
						<a href="javascript:;">饭团</a>
					</li>
					<li>
						<a href="javascript:;">资讯</a>
					</li>
					<li>
						<a href="javascript:;">我的家</a>
					</li>
					<li>
						<a href="javascript:;">APP下载</a>
					</li>
					<li>
						<a href="javascript:;">热门应用</a>
					</li>
				</ul>
			</div>
			<div id="conWrap">
				<div id="content">
				<!--导航-->
				<div id="navsWrap">
					<ul id="navsList">
					<li class="active">
						<a href="javascript:;">首页</a>
					</li>
					<li>
						<a href="javascript:;">MV</a>
					</li>
					<li>
						<a href="javascript:;">悦单</a>
					</li>
					<li>
						<a href="javascript:;">V榜</a>
					</li>
					<li>
						<a href="javascript:;">音悦</a>
					</li>
					<li>
						<a href="javascript:;">商城</a>
					</li>
					<li>
						<a href="javascript:;">节目</a>
					</li>
					<li>
						<a href="javascript:;">饭团</a>
					</li>
					<li>
						<a href="javascript:;">资讯</a>
					</li>
					<li>
						<a href="javascript:;">我的家</a>
					</li>
					<li>
						<a href="javascript:;">APP下载</a>
					</li>
					<li>
						<a href="javascript:;">热门应用</a>
					</li>
					</ul>
				</div>
				<!--无缝滑屏-->
				<div id="ban_wrap">
					<ul id="ban_list">
						<li>
							<a href="###">
								<img src="img/1.jpg"/>
							</a>
						</li>
						<li>
							<a href="###">
								<img src="img/2.jpg"/>
							</a>
						</li>
						<li>
							<a href="###">
								<img src="img/3.jpg"/>
							</a>
						</li>
						<li>
							<a href="###">
								<img src="img/4.jpg"/>
							</a>
						</li>
						<li>
							<a href="###">
								<img src="img/5.jpg"/>
							</a>
						</li>
					</ul>
					<div id="ban_navs">
						<span class="active"></span>
						<span></span>
						<span></span>
						<span></span>
						<span></span>
					</div>
				</div>
				<!--tab选项卡-->
				<div class="tab">
					<div class="tabHeader">
						<h2>MV首播</h2>
						<a href="#">更多&gt;</a>
					</div>
					<nav class="tabNav">
						<a href="#">全部</a>
						<a href="#">内地</a>
						<a href="#">港台</a>
						<a href="#">欧美</a>
						<a href="#">日本</a>
						<a href="#">韩国</a>
						<span></span>
					</nav>
					<div class="tabWrap">
						<ul class="tabLoading"></ul>
						<ul class="tabList">
							<li>
								<img src="img/a.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/b.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/c.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/d.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/e.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/f.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tabLoading"></ul>
					</div>
				</div>
				<div class="tab">
					<div class="tabHeader">
						<h2>MV首播</h2>
						<a href="#">更多&gt;</a>
					</div>
					<nav class="tabNav">
						<a href="#">全部</a>
						<a href="#">内地</a>
						<a href="#">港台</a>
						<a href="#">欧美</a>
						<a href="#">日本</a>
						<a href="#">韩国</a>
						<span></span>
					</nav>
					<div class="tabWrap">
						<ul class="tabLoading"></ul>
						<ul class="tabList">
							<li>
								<img src="img/a.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/b.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/c.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/d.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/e.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/f.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tabLoading"></ul>
					</div>
				</div>
				<div class="tab">
					<div class="tabHeader">
						<h2>MV首播</h2>
						<a href="#">更多&gt;</a>
					</div>
					<nav class="tabNav">
						<a href="#">全部</a>
						<a href="#">内地</a>
						<a href="#">港台</a>
						<a href="#">欧美</a>
						<a href="#">日本</a>
						<a href="#">韩国</a>
						<span></span>
					</nav>
					<div class="tabWrap">
						<ul class="tabLoading"></ul>
						<ul class="tabList">
							<li>
								<img src="img/a.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/b.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/c.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/d.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/e.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/f.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tabLoading"></ul>
					</div>
				</div>
				<div class="tab">
					<div class="tabHeader">
						<h2>MV首播</h2>
						<a href="#">更多&gt;</a>
					</div>
					<nav class="tabNav">
						<a href="#">全部</a>
						<a href="#">内地</a>
						<a href="#">港台</a>
						<a href="#">欧美</a>
						<a href="#">日本</a>
						<a href="#">韩国</a>
						<span></span>
					</nav>
					<div class="tabWrap">
						<ul class="tabLoading"></ul>
						<ul class="tabList">
							<li>
								<img src="img/a.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/b.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/c.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/d.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/e.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/f.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tabLoading"></ul>
					</div>
				</div>
				<div class="tab">
					<div class="tabHeader">
						<h2>MV首播</h2>
						<a href="#">更多&gt;</a>
					</div>
					<nav class="tabNav">
						<a href="#">全部</a>
						<a href="#">内地</a>
						<a href="#">港台</a>
						<a href="#">欧美</a>
						<a href="#">日本</a>
						<a href="#">韩国</a>
						<span></span>
					</nav>
					<div class="tabWrap">
						<ul class="tabLoading"></ul>
						<ul class="tabList">
							<li>
								<img src="img/a.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/b.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/c.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/d.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/e.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
							<li>
								<img src="img/f.jpg"/>
								<span>君に贈る花がない</span>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>999+</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>6</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tabLoading"></ul>
					</div>
				</div>
			</div>
			</div>
		</div>
		<div id="scrollBar"></div>
	</body>
	<script type="text/javascript" src="js/transformCss.js"></script>
	<script type="text/javascript" src="js/verticalDrag.js"></script>
	<script type="text/javascript">
		document.addEventListener('touchstart',function(event){
			event.preventDefault();
		});
		
		(function(){
			var width = document.documentElement.clientWidth;
			var styleN = document.createElement('style');
			styleN.innerHTML = 'html{font-size:'+ width/16 +'px !important}';
			document.head.appendChild(styleN);
		})();
		
		window.onload = function(){
			changeMenu();
			navs();
			changeColor()
			banner();
			tab();
			drag();
		}
		
		//菜单按钮切换
		function changeMenu(){

			var menuBtn = document.getElementById('menuBtn');
			var list = document.getElementById('list');
			
			
			menuBtn.addEventListener('touchstart',function(event){
				if(menuBtn.className == 'menuBtnClos'){
					menuBtn.className = 'menuBtnShow';
					list.style.display = 'block';
				}else{
					menuBtn.className = 'menuBtnClos';
					list.style.display = 'none';
				}
				//取消冒泡
				event.stopPropagation();
			})
			
			//点击其他区域，遮罩(定位层)消失
			document.addEventListener('touchstart',function(){
				if(menuBtn.className == 'menuBtnShow'){
					menuBtn.className = 'menuBtnClos';
					list.style.display = 'none';
				}
			})
			list.addEventListener('touchstart',function(event){
				//取消冒泡
				event.stopPropagation();
			})
		}
		//导航区
		function navs(){
			var navsWrap = document.getElementById('navsWrap');
			var navsList = document.getElementById('navsList');
			transformCss(navsList,'translateZ',0.1);
			
			//定义手指初始值
			var eleX = 0;
			var startX = 0;
			//手指距离差
			var disX = 0;

			
			//定义用于得到速度的几个变量
			var beginTime,endTime,speed;
			var disTime = 1;//防止分母为0，得NAN，不能移动了
			 
			
			navsWrap.addEventListener('touchstart',function(event){
				var touch = event.changedTouches[0];
				
				//清除过渡
				navsList.style.transition = 'none';
				
				eleX = transformCss(navsList,'translateX');
				startX = touch.clientX;
				
				//取得手指开始移动的时间 
				beginTime = new Date().getTime();
				disX = 0;
			})
			navsWrap.addEventListener('touchmove',function(event){
				var touch = event.changedTouches[0];
				
				var endX = touch.clientX;
				disX = endX - startX;
				
				
				var translateX = disX + eleX;
				
				//定义一个系数，模拟它变小的值，橡皮筋拖的效果     越来越难拖
				var scale = 0;
				var minX = document.documentElement.clientWidth - navsList.offsetWidth;
				
				if(translateX>0){
					//模拟系数
					scale = 1 - translateX/document.documentElement.clientWidth;
					translateX = translateX*scale;
				}else if(translateX<minX){
					//rightSpace 得到一个正值
					var rightSpace = minX - translateX;
					scale = 1 - rightSpace/document.documentElement.clientWidth;
					translateX = minX - rightSpace*scale;
				}
				transformCss(navsList,'translateX',translateX);
				
				//获取手指移动的时间
				endTime = new Date().getTime();
				disTime = endTime - beginTime;
			})
			
			//快速滑屏效果（move结束之后有一段缓冲距离）
			navsWrap.addEventListener('touchend',function(){
				
				speed = disX/disTime;
//				console.log(speed,endTime,beginTime)
//				console.log(speed);需添加过渡才能看出来效果
				//目标位移距离  = touchmove产生的距离 + 速度计算出的结果
				var target = transformCss(navsList,'translateX') + speed*100;
				//每次添加过渡，得注意在touchstart里清除过渡，不然move里有平移的地方，过渡得行内样式依然存在

 
				//右边临界状态
				var minX = document.documentElement.clientWidth - navsList.offsetWidth;
				var bezier;
				//橡皮筋回弹效果 用bezier
				if(target>0){
					target = 0;
					bezier = 'cubic-bezier(.09,1.61,.92,1.45)';
				}else if(target<minX){
					target = minX;
					bezier = 'cubic-bezier(.09,1.61,.92,1.45)';
				}
				navsList.style.transition = '3s ' + bezier;
				transformCss(navsList,'translateX',target);
				
			})
		}
		
		//点击变色
		function changeColor(){
			var liNodes = document.querySelectorAll('#navsList li');
			
			//防止误触
			for(var i=0;i<liNodes.length;i++){
				liNodes[i].addEventListener('touchmove',function(){
					if(!this.ismove){//得深刻理解
						this.ismove = true;//光touchstart的时候不触发
					}//this是一个对象，this.ismove = true相当于给一个对象添加名值对，即设置一个属性
				});
				//标识对象的状态，如果处于这种状态，则不执行代码
				liNodes[i].addEventListener('touchend',function(){
					if(!this.ismove){
						for(var j=0;j<liNodes.length;j++){
							liNodes[j].className = '';
						}
						this.className = 'active';
					}
					//重置  不然this.ismove有可能一直是true
					this.ismove = false;
				});
			}
		}
		
		//banner区域	
		function banner(){
			//获取元素
			var wrap = document.getElementById('ban_wrap');
			var list = document.getElementById('ban_list');
			transformCss(list,'translateZ',0.1);
			//动态添加li
			list.innerHTML += list.innerHTML;
			var liNodes = document.querySelectorAll('#ban_list li');
			var spanNodes = document.querySelectorAll('#ban_navs span');
		
			//布局
			var styleN = document.createElement('style');
			styleN.innerHTML += '#ban_list{width: '+ liNodes.length +'00%;}';
			styleN.innerHTML += '#ban_list li{width: '+ (100/liNodes.length) +'%;}';
			styleN.innerHTML += '#ban_wrap{height: '+ liNodes[0].offsetHeight +'px;}';
			document.head.appendChild(styleN);
		
			//横向滑屏
			//定义元素初始位置，手指初始位置
			var eleX = 0;
			var startX = 0;
			
			//保存2d变换每一次的位移值
//			var translateX = 0;

			//定时器
			var timer = 0;
			//模拟now
			var now = 0;
			
			var startY = 0;//防抖动
			var isfirst = true;
			var isX = true;
		
			wrap.addEventListener('touchstart',function(event){
				var touch = event.changedTouches[0];

				
				//清除定时器
				clearInterval(timer);
				
				//清除过渡
				list.style.transition = 'none';
				
				//无缝
				var left = transformCss(list,'translateX');				
				var now = Math.round(-left / document.documentElement.clientWidth);				
				if(now == 0){
					now = spanNodes.length;
				}else if(now == liNodes.length-1){
					now = spanNodes.length -1;
				};
				//切换动作
				transformCss(list,'translateX',-now*document.documentElement.clientWidth);
			
				//读
				eleX = transformCss(list,'translateX');
				startX = touch.clientX;
				
				startY = touch.clientY;
				//重置
				isfirst = true;
				isX = true;
				
			});
			wrap.addEventListener('touchmove',function(event){
				var touch = event.changedTouches[0];
				
				if(!isX){
					return;//禁止X方向的逻辑
				}
				
				//手指结束位置
				var endX = touch.clientX;
				//手指距离差
				var disX = endX - startX;
				
				var endY = touch.clientY;
				var disY = endY - startY;
				
				//防抖动
				if(isfirst){
					isfirst=false;
					if(Math.abs(disY)>Math.abs(disX)){
						isX=false;
						disX=0;
						//return 不能把外部逻辑全部禁止掉，原因touchmove持续不断出发的
					}
				}
				
				//写
				transformCss(list,'translateX',disX + eleX);

			});
			wrap.addEventListener('touchend',function(event){
				var touch = event.changedTouches[0];
				
				//定义图片索引下标
				var now = 0;

				//读
				var left = transformCss(list,'translateX');
				
				now = Math.round(-left / document.documentElement.clientWidth);
				
				//范围限定
				if(now < 0){
					now = 0;
				}else if(now > liNodes.length-1){
					now = liNodes.length-1;
				};

				//写
				//过渡
				list.style.transition = '1s';
				transformCss(list,'translateX',-now * document.documentElement.clientWidth);

			
				//处理小圆点
				for(var i=0;i<spanNodes.length;i++){
					spanNodes[i].className = '';
				};
				spanNodes[now%spanNodes.length].className = 'active';
			
				//开启定时器
				auto();
			});
		
	
			//自动轮播
			
			auto();
			function auto(){
				//清除定时器
				clearInterval(timer);
				timer = setInterval(function(){
					//无缝
					if(now == liNodes.length-1){
						now = spanNodes.length -1;
					};
					//切换动作
					//清除过渡
					list.style.transition = 'none';
					transformCss(list,'translateX',-now*document.documentElement.clientWidth);
					
					setTimeout(function(){
						now++;
						list.style.transition = '0.5s';
						transformCss(list,'translateX',-now*document.documentElement.clientWidth);
						//处理小圆点
						for(var i=0;i<spanNodes.length;i++){
							spanNodes[i].className = '';
						};
						spanNodes[now%spanNodes.length].className = 'active';
					},20);
				},1000);
			};
			
		};
		
		//tab区
		function tab(){
			var tabWrap = document.querySelectorAll('.tabWrap');
			var tabNav = document.querySelectorAll('.tabNav');
			
			var translateX = tabNav[0].offsetWidth;
			
			for(var i=0;i<tabWrap.length;i++){
				move(tabWrap[i],tabNav[i]);
			}
			
			function move(tabWrap,tabNav){
				//加3d变换，是为了消除2d产生的晃动
				//哪个元素有2d，就给它加上3d
				transformCss(tabWrap,'translateZ',0.1);
				transformCss(tabNav,'translateZ',0.1);
				transformCss(tabWrap,'translateX',-translateX);
				
				var eleX = 0;
				var startX = 0;
				//防抖动
				var startY = 0;
				var isfirst = true;
				var isX = true;
				
				//获取Loading
				var loading = tabWrap.querySelectorAll('.tabLoading');
				//Loading标识 -- 编程中常用的方法
				var isLoading = false;//初始状态Loading透明度为0
				
				//小绿条
				var smallG = tabNav.querySelector('span');
				var aNodes = tabNav.querySelectorAll('a');
				var nowA = 0;//模拟a下标
				
				tabWrap.addEventListener('touchstart',function(event){
					var touch = event.changedTouches[0];
					// 如果处于Loading，什么都不能做
					if(isLoading){
						return;
					}
					
					tabWrap.style.transition = 'none';
					
					eleX = transformCss(tabWrap,'translateX');
					startX = touch.clientX;
					startY = touch.clientY;
					
					//重置
					isfirst = true;
					isX = true;
				});
				tabWrap.addEventListener('touchmove',function(event){
					var touch = event.changedTouches[0];
					if(!isX){
						return;
					}
					
					if(isLoading){
						return;
					}
					
					var endX = touch.clientX;
					var endY = touch.clientY;
					//手指距离差
					var disX = endX - startX;
					var disY = endY - startY;
					
					if(isfirst){
						isfirst=false;
						if(Math.abs(disY)>Math.abs(disX)){
							isX=false;
							disX=0;
						}
					}
					
					transformCss(tabWrap,'translateX',disX+eleX);
				})
				tabWrap.addEventListener('touchend',function(event){
					var touch = event.changedTouches[0];
					
					if(isLoading){
						return;
					}
					
					var endX = touch.clientX;
					var disX = endX - startX;
					
					if(Math.abs(disX)<translateX/2){
						tabWrap.style.transition = '0.5s';
						transformCss(tabWrap,'translateX',-translateX);
					}
					
					if(Math.abs(disX)>translateX/2){
						var target = disX>0 ? 0:-2*translateX;
						
						tabWrap.style.transition = '0.5s';
						transformCss(tabWrap,'translateX',target);
						
						//nowA范围
						nowA = disX>0 ? nowA+1 : nowA-1;
						if(nowA<0){
							nowA = aNodes.length-1;
						}else if(nowA>aNodes.length-1){
							nowA = 0;
						}
						//小绿条平移
						smallG.style.transition = '0.5s';
						transformCss(smallG,'translateX',aNodes[nowA].offsetLeft);
						
						isLoading = true;
						
						//过渡结束之后出现
						//兼容
						tabWrap.addEventListener('transitionEnd',fun);
						tabWrap.addEventListener('webkitTransitionEnd',fun);
						
						function fun(){
							//loading真正出现（opacity ：1）
							for (var i=0;i<loading.length;i++) {
								loading[i].style.opacity = '1';
							}
							
							//主题区域回来--延迟调用
							setTimeout(function(){
								tabWrap.style.transition = '0.5s';
								transformCss(tabWrap,'translateX',-translateX);
								isLoading = false;
								for (var i=0;i<loading.length;i++) {
									loading[i].style.opacity = '0';
								}
							},3000)
							//解绑  性能优化(注意：放在fun里，代码执行顺序)
							tabWrap.removeEventListener('transitionEnd',fun);
							tabWrap.removeEventListener('webkitTransitionEnd',fun);
						}
						
					}
					
				})
			}
		}
		
		//竖向滑屏
		function drag(){
			var conWrap = document.getElementById('conWrap');
			var content = document.getElementById('content');
			var scrollBar = document.getElementById('scrollBar');
			/*header.addEventListener('touchmove',function(event){
				event.stopPropagation();
			})*///除了取消冒泡，也可另外给content一个父元素，给其绑定事件，就不关header什么事了
			var scale = document.documentElement.clientHeight/content.offsetHeight;
			//offsetHeight取得的高度包括padding（占地面积）
			scrollBar.style.height = document.documentElement.clientHeight*scale + 'px';
			
			var callback = {
				start:function(){
					scrollBar.style.opacity = '1';
				},
				move:function(){
//					var dis = conWrap.offsetTop;
//					console.log(dis);
					//滚动条的偏移量=content的偏移量*scale
					var dis = transformCss(content,'translateY')*scale;
//					scrollBar.style.top = -dis + 'px';
					transformCss(scrollBar,'translateY',-dis);
				},
				end:function(){
					scrollBar.style.opacity = '0';
				}
			}
			
			verticalDrag(conWrap,callback);
		}
	</script>
</html>
